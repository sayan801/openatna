<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
    <title>org.openhealthtools.openatna.persistence</title>
</head>
<body>
<p>
    This package contains the persitence model and entities for ATNA.
    The model divides the DB into two parts.
</p>

<p>
    The first are those
    entities that are defined and loaded by the domain user of the DB. These
    include the coded value types for event id, event types, source, participant
    and object ids etc.
</p>

<p>
    The second part consists of entities that are added to the DB through the process
    of auditing. These entities reference the domain defined values already in the DB.
    Entities and DAOs of this sort all begin with "Atna" in the class name.
    An AtnaPersistenceException is thrown if Atna entities reference domain objects
    that are not in the DB already. In general, this test is done using the business
    identifier for the domain objects. When this test occurs, the reference in the
    entity is changed to the object already stored in the DB. This means some fields
    in the object could be different from those received in a message, if they are
    not used for comparison.
</p>

<p>
    This package does not address user access to entities. Write access to domain
    defined entities should be restricted to domain admins, and modification and deletion
    of audit generated entities should also be restricted.
</p>

<p>
    Thre is a utility class called DataReader which takes an XML file containing
    descriptions of domain defined entites, and loads these into the data base.
    Below is a template of all the possible values accepted in the XML.
    Empty attributes can be left there
    or removed.

    The "id" attributes are used to reference other elements via the "ref" attribute.
    These should be unique within the document.

    Required fields:
<ul>
    <li>codes all need a "code" attribute</li>
    <li>netPoints need both "netId" and "type"</li>
    <li>details need both "type" and some child content</li>
    <li>sources require a "sourceId"</li>
    <li>participants require a "userId"</li>
    <li>objects require an "objectId" and a reference to an objectIdType code.</li>
</ul>
    
       <pre>
&lt;entities>
    &lt;codes>
        &lt;eventId id="" code="" system="" systemName="" displayName="" originalText=""/>
        &lt;eventType id="" code="" system="" systemName="" displayName="" originalText=""/>
        &lt;objectIdType id="" code="" system="" systemName="" displayName="" originalText=""/>
        &lt;participantType id="" code="" system="" systemName="" displayName="" originalText=""/>
        &lt;sourceType id="" code="" system="" systemName="" displayName="" originalText=""/>
    &lt;/codes>

    &lt;netPoints>
        &lt;netPoint id="" netId="" type=""/>
    &lt;/netPoints>

    &lt;sources>
        &lt;source id="" sourceId="" enterpriseSiteId="">
            &lt;sourceType ref=""/>
        &lt;/source>
    &lt;/sources>

    &lt;participants>
        &lt;participant id="" userId="" altUserId="" userName="">
            &lt;participantType ref=""/>
        &lt;/participant>
    &lt;/participants>

    &lt;objects>
        &lt;object id="" objectId="" objectTypeCode="" objectTypeCodeRole="" objectName="" sensitivity="">
            &lt;objectIdType ref=""/>
            &lt;objectDetailKey key=""/>
        &lt;/object>
    &lt;/objects>
&lt;/entities> 
           
           
       </pre>


</p>
</body>
</html>
